<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- Generated by T-Systems -->
<hibernate-mapping>
    <class name="com.rsi.agp.dao.tables.anexo.AnexoModificacion" table="TB_ANEXO_MOD">
        <comment>Tabla principal de p&#243;lizas para lOS Anexos Modificacion Poliza</comment>
        <id name="id" type="long">
            <column name="ID" precision="15" scale="0" />
            <generator class="sequence">
            	<param name="sequence">SQ_TB_ANEXO_MOD</param>
            </generator>        
        </id>
        <many-to-one name="estadoAgroseguro" class="com.rsi.agp.dao.tables.inc.EstadosInc" fetch="select">
            <column name="IDESTADO_AGRO" precision="1" scale="0" />
        </many-to-one>
        <many-to-one name="cupon" class="com.rsi.agp.dao.tables.anexo.Cupon" fetch="select">
            <column name="IDCUPON" precision="15" scale="0">
                <comment>Identificador del cupon asociado</comment>
            </column>
        </many-to-one>
        <many-to-one name="comunicaciones" class="com.rsi.agp.dao.tables.poliza.Comunicaciones" fetch="select" lazy="no-proxy">
            <column name="IDENVIO" precision="15" scale="0">
                <comment>Identificador Env&#237;o Anexo.</comment>
            </column>
        </many-to-one>
        <many-to-one name="estado" class="com.rsi.agp.dao.tables.anexo.Estado" fetch="select" lazy="no-proxy">
            <column name="ESTADO" precision="2" scale="0">
                <comment>Identificador Estado Anexo.</comment>
            </column>
        </many-to-one>
        <many-to-one name="poliza" class="com.rsi.agp.dao.tables.poliza.Poliza" fetch="select" lazy="no-proxy">
            <column name="IDPOLIZA" precision="15" scale="0">
                <comment>Identificador Poliza.</comment>
            </column>
        </many-to-one>
        <property name="idcopy" type="long">
            <column name="IDCOPY" precision="15" scale="0">
                <comment>Identificador Copy.</comment>
            </column>
        </property>
        <property name="fechafirmadoc" type="java.util.Date">
            <column name="FECHAFIRMADOC">
                <comment>Fecha Firma Documento</comment>
            </column>
        </property>
        <property name="asunto" type="string">
            <column name="ASUNTO" length="2000">
                <comment>Asunto Anexo.</comment>
            </column>
        </property>
        <property name="nomaseg" type="string">
            <column name="NOMASEG" length="20">
                <comment>Nombre Asegurado Modificado en Anexo</comment>
            </column>
        </property>
        <property name="apel1aseg" type="string">
            <column name="APEL1ASEG" length="40">
                <comment>Primer Apellido Modificado en Anexo</comment>
            </column>
        </property>
        <property name="apel2aseg" type="string">
            <column name="APEL2ASEG" length="40">
                <comment>Segundo Apellido Modificado en Anexo</comment>
            </column>
        </property>
        <property name="razsocaseg" type="string">
            <column name="RAZSOCASEG" length="100">
                <comment>Razon Social Modificado en Anexo</comment>
            </column>
        </property>
        <property name="calleaseg" type="string">
            <column name="CALLEASEG" length="25">
                <comment>Calle Modificado en Anexo</comment>
            </column>
        </property>
        <property name="numaseg" type="string">
            <column name="NUMASEG" length="5">
                <comment>Numero Calle Modificado en Anexo</comment>
            </column>
        </property>
        <property name="codprovincia" type="java.math.BigDecimal">
            <column name="CODPROVINCIA" precision="2" scale="0">
                <comment>Provincia Asegurado Modificado en Anexo</comment>
            </column>
        </property>
        <property name="codlocalidad" type="java.math.BigDecimal">
            <column name="CODLOCALIDAD" precision="3" scale="0">
                <comment>Localidad Asegurado Modificado en Anexo</comment>
            </column>
        </property>
        <property name="codposaseg" type="string">
            <column name="CODPOSASEG" length="5">
                <comment>Codigo Postal Asegurado Modificado en Anexo</comment>
            </column>
        </property>
        <property name="pisoaseg" type="string">
            <column name="PISOASEG" length="5">
                <comment>Piso Asegurado Modificado en Anexo</comment>
            </column>
        </property>
        <property name="bloqueaseg" type="string">
            <column name="BLOQUEASEG" length="3">
                <comment>Bloque Asegurado Modificado en Anexo</comment>
            </column>
        </property>
        <property name="escaseg" type="string">
            <column name="ESCASEG" length="3">
                <comment>Escalera Asegurado Modificado en Anexo</comment>
            </column>
        </property>
        <property name="telffijoaseg" type="string">
            <column name="TELFFIJOASEG" length="9">
                <comment>Telefono fijo Asegurado Modificado en Anexo</comment>
            </column>
        </property>
        <property name="telfmovilaseg" type="string">
            <column name="TELFMOVILASEG" length="9">
                <comment>Telefono Movil Asegurado Modificado en Anexo</comment>
            </column>
        </property>
        <property name="email" type="string">
            <column name="EMAIL" length="50">
                <comment>Email Asegurado Modificado en Anexo</comment>
            </column>
        </property>
        <property name="numsegsocial" type="string">
            <column name="NUMSEGSOCIAL" length="12">
                <comment>Mumero Seguridad Social Asegurado Modificado en Anexo</comment>
            </column>
        </property>
        <property name="regimensegsocial" type="string">
            <column name="REGIMENSEGSOCIAL" length="12">
                <comment>Regimen Seguridad Social Modificado en Anexo</comment>
            </column>
        </property>
        <property name="codmodulo" type="string">
            <column name="CODMODULO" length="5">
                <comment>Codigo Modulo Cobertura Modificado en Anexo</comment>
            </column>
        </property>
        <property name="xml" type="clob">
            <column name="XML">
                <comment>Fichero enviado a Agroseguro</comment>
            </column>
        </property>
        <property name="nomlocalidad" type="string">
            <column name="NOMLOCALIDAD" length="30">
                <comment>Nombre de la localidad</comment>
            </column>
        </property>
        <property name="tipoEnvio" type="string">
            <column name="TIPO_ENVIO" length="3">
                <comment>Tipo de envio del anexo. Puede ser FTP o SW</comment>
            </column>
        </property>
        <property name="fechaAlta" type="java.util.Date">
            <column name="FECHA_ALTA">
                <comment>Fecha de alta del anexo</comment>
            </column>
        </property>
        <property name="usuarioAlta" type="string">
            <column name="USUARIO_ALTA" length="8">
                <comment>Usuario que da de alta el anexo</comment>
            </column>
        </property>
        <property name="fechaBaja" type="java.util.Date">
            <column name="FECHA_BAJA">
                <comment>Fecha de baja del anexo</comment>
            </column>
        </property>
        <property name="usuarioBaja" type="string">
            <column name="USUARIO_BAJA" length="8">
                <comment>Usuario que da de baja el anexo</comment>
            </column>
        </property>
        <property name="revisarSbp" type="java.lang.Character">
            <column name="REVISAR_SBP" length="1">
                <comment>Indica si el hay que revisar el anexo para generar suplemento de sobreprecio (S/N)</comment>
            </column>
        </property>
        <property name="pctadministracion" type="java.math.BigDecimal">
            <column name="PCTADMINISTRACION" precision="5">
                <comment>Porcentaje de administraci&#243;n con el que se contrat&#243; la p&#243;liza asociada</comment>
            </column>
        </property>
        <property name="pctadquisicion" type="java.math.BigDecimal">
            <column name="PCTADQUISICION" precision="5">
                <comment>Porcentaje de adquisici&#243;n con el que se contrat&#243; la p&#243;liza asociada</comment>
            </column>
        </property>
        <property name="pctcomisionmediador" type="java.math.BigDecimal">
            <column name="PCTCOMISIONMEDIADOR" precision="5">
                <comment>Porcentaje de comisi&#243;n del mediador con el que se contrat&#243; la p&#243;liza asociada</comment>
            </column>
        </property>
        <property name="ibanAsegOriginal" type="string">
            <column name="IBAN_ASEG_ORIGINAL" length="24">
                <comment>IBAN ORIGINAL pago prima. Extraído de la situación actualizada de la poliza</comment>
            </column>
        </property>
        <property name="esIbanAsegModificado" type="java.lang.Integer">
            <column name="IBAN_ASEG_MODIF" precision="1" scale="0">
                <comment>Indica si el IBAN pago prima ha cambiado respecto del recibido en la situaci&#243;n actualizada (0 - NO, 1 - SI)</comment>
            </column>
        </property>
        <property name="ibanAsegModificado" type="string">
            <column name="IBAN_ASEG_MODIFICADO" length="24">
                <comment>Ultimo IBAN pago prima modificado y actual. Si no ha sido modificado el IBAN actual será el original</comment>
            </column>
        </property>
        <property name="iban2AsegOriginal" type="string">
            <column name="IBAN2_ASEG_ORIGINAL" length="24">
                <comment>IBAN ORIGINAL cobro siniestros. Extraido de la situacion actualizada de la poliza</comment>
            </column>
        </property>
        <property name="esIban2AsegModificado" type="java.lang.Integer">
            <column name="IBAN2_ASEG_MODIF" precision="1" scale="0">
                <comment>Indica si el IBAN cobro siniestros ha cambiado respecto del recibido en la situacion actualizada (0 - NO, 1 - SI)</comment>
            </column>
        </property>
        <property name="iban2AsegModificado" type="string">
            <column name="IBAN2_ASEG_MODIFICADO" length="24">
                <comment>Ultimo IBAN cobro siniestros modificado y actual. Si no ha sido modificado el IBAN actual sera el original</comment>
            </column>
        </property>
        <!--   Pet. 78691 ** MODIF TAM (15.12.2021) * INICIO *--> 
        <property name="codCaractExplotacion" type="java.math.BigDecimal">
            <column name="CODCARACTEXPLOTACION" precision="3" scale="0">
                <comment>Caracteristica de Explotacion del Anexo</comment>
            </column>
        </property>
        <!--   Pet. 78691 ** MODIF TAM (15.12.2021) * FIN *-->
        <property name="pctdescelegido" type="java.math.BigDecimal">
            <column name="PCTDESCELEGIDO" precision="5">
                <comment>Porcentaje de descuento elegido</comment>
            </column>
        </property>
        <property name="pctrecarelegido" type="java.math.BigDecimal">
            <column name="PCTRECARELEGIDO" precision="5">
                <comment>Porcentaje de recargo elegido</comment>
            </column>
        </property>
        <property name="pctadministracionResto" type="java.math.BigDecimal">
            <column name="PCTADMINISTRACION_RESTO" precision="5">
                <comment>Porcentaje de administraci&#195;&#179;n con el que se contrat&#195;&#179; la p&#195;&#179;liza asociada (G.N Resto)</comment>
            </column>
        </property>
        <property name="pctadquisicionResto" type="java.math.BigDecimal">
            <column name="PCTADQUISICION_RESTO" precision="5">
                <comment>Porcentaje de adquisici&#195;&#179;n con el que se contrat&#195;&#179; la p&#195;&#179;liza asociada (G.N Resto)</comment>
            </column>
        </property>
        <property name="pctcomisionmediadorResto" type="java.math.BigDecimal">
            <column name="PCTCOMISIONMEDIADOR_RESTO" precision="5">
                <comment>Porcentaje de comisi&#195;&#179;n del mediador con el que se contrat&#195;&#179; la p&#195;&#179;liza asociada (G.N Resto)</comment>
            </column>
        </property>
        <property name="pctdescelegidoResto" type="java.math.BigDecimal">
            <column name="PCTDESCELEGIDO_RESTO" precision="5">
                <comment>Porcentaje de descuento elegido (G.N Resto)</comment>
            </column>
        </property>
        <property name="pctrecarelegidoResto" type="java.math.BigDecimal">
            <column name="PCTRECARELEGIDO_RESTO" precision="5">
                <comment>Porcentaje de recargo elegido (G.N Resto)</comment>
            </column>
        </property>
                <property name="fechaSeguimiento" type="java.util.Date">
            <column name="FECHA_SEGUIMIENTO" />
        </property>
        <property name="usuarioDefinitiva" type="string" lazy="true" formula="(select ah.CODUSUARIO from o02agpe0.VW_ANEXO_MOD_HIST_ESTADOS_DESC ah where ah.IDANEXO = ID  and ah.ESTADO=5 and rownum=1)"/>
       
        <property name="fechaDefinitiva" type="java.util.Date" lazy="true" formula="(select ah.FECHA from o02agpe0.VW_ANEXO_MOD_HIST_ESTADOS_DESC ah where ah.IDANEXO = ID and ah.ESTADO=5 and rownum=1)"/>
           
     	<!-- Importe de la póliza final -->
     	<property name="importePlzFinal" type="java.math.BigDecimal" lazy="true" formula="(select dc.total_coste_tomador from o02agpe0.tb_anexo_mod_dist_costes dc where dc.idanexo= ID and dc.tipo_dc=0 and rownum=1)"/>
     	<!-- Importe de la modificación -->
     	<property name="importeModificacion" type="java.math.BigDecimal" lazy="true" formula="(select dc.total_coste_tomador from o02agpe0.tb_anexo_mod_dist_costes dc where dc.idanexo= ID and dc.tipo_dc=1 and rownum=1)"/>
     
      	<property name="fechaEnvioAnexo" type="java.util.Date" lazy="true"   
            formula="(SELECT NVL((select max(ec.fecha) from o02agpe0.tb_anexo_mod_sw_envios_conf ec where ec.idcupon=IDCUPON), 
				(select max(o02agpe0.TB_COMUNICACIONES.FECHA_ENVIO)  from o02agpe0.TB_COMUNICACIONES where o02agpe0.TB_COMUNICACIONES.IDENVIO=IDENVIO)) FROM DUAL)"
            /> 
        <set name="parcelas" table="TB_ANEXO_MOD_PARCELAS" inverse="true" lazy="extra" fetch="select">
            <key>
                <column name="IDANEXO" precision="15" scale="0" not-null="true">
                    <comment>Identificador del Anexo</comment>
                </column>
            </key>
            <one-to-many class="com.rsi.agp.dao.tables.anexo.Parcela" />
        </set>
        <set name="explotacionAnexos" table="TB_ANEXO_MOD_EXPLOTACIONES" inverse="true" lazy="extra" fetch="select">
            <key>
                <column name="ID_ANEXO" precision="15" scale="0" not-null="true">
                    <comment>Id del anexo</comment>
                </column>
            </key>
            <one-to-many class="com.rsi.agp.dao.tables.poliza.explotaciones.ExplotacionAnexo" />
        </set>
        <set name="subvDeclaradas" table="TB_ANEXO_MOD_SUBV_DECL" inverse="true" lazy="extra" fetch="select">
            <key>
                <column name="IDANEXO" precision="15" scale="0" not-null="true">
                    <comment>Identificador Anexo Modificacion</comment>
                </column>
            </key>
            <one-to-many class="com.rsi.agp.dao.tables.anexo.SubvDeclarada" />
        </set>
        <set name="parcelaSWRendimientos" table="TB_ANEXO_MOD_PAR_SW_RENDIMIENT" inverse="true" lazy="true" fetch="select">
            <key>
                <column name="IDANEXO" precision="15" scale="0" not-null="true">
                    <comment>Identificador del anexo asociado a la llamada al SW de rendimientos</comment>
                </column>
            </key>
            <one-to-many class="com.rsi.agp.dao.tables.anexo.ParcelaAMSWRendimiento" />
        </set>
        <set name="coberturas" table="TB_ANEXO_MOD_COBERTURAS" inverse="true" lazy="extra" fetch="select">
            <key>
                <column name="IDANEXO" precision="15" scale="0" not-null="true">
                    <comment>Identificador Anexo Modificacion</comment>
                </column>
            </key>
            <one-to-many class="com.rsi.agp.dao.tables.anexo.Cobertura" />
        </set>
        <set name="enviosSWConfirmacions" table="TB_ANEXO_MOD_SW_ENVIOS_CONF" inverse="true" lazy="extra" fetch="select" cascade="delete">
            <key>
                <column name="IDANEXO" precision="15" scale="0" not-null="true">
                    <comment>Identificador del anexo</comment>
                </column>
            </key>
            <one-to-many class="com.rsi.agp.dao.tables.anexo.EnviosSWConfirmacion" />
        </set>
        <set name="anexoModSWCalculos" table="TB_ANEXO_MOD_SW_CALCULO" inverse="true" lazy="true" fetch="select">
            <key>
                <column name="IDANEXO" precision="15" scale="0" not-null="true">
                    <comment>Identificador del anexo asociado</comment>
                </column>
            </key>
            <one-to-many class="com.rsi.agp.dao.tables.anexo.AnexoModSWCalculo" />
        </set>
         <set name="anexoModDistribucionCosteses" table="TB_ANEXO_MOD_DIST_COSTES" inverse="true" lazy="true" fetch="select">
            <key>
                <column name="IDANEXO" precision="15" scale="0" not-null="true">
                    <comment>Identificador del anexo asociado</comment>
                </column>
            </key>
            <one-to-many class="com.rsi.agp.dao.tables.anexo.AnexoModDistribucionCostes" />
        </set>
        <set name="anexoModSWComparativases" table="TB_ANEXO_MOD_SW_COMPARATIVAS" inverse="true" lazy="true" fetch="select">
            <key>
                <column name="IDANEXO" precision="15" scale="0" not-null="true">
                    <comment>Identificador del anexo asociado</comment>
                </column>
            </key>
            <one-to-many class="com.rsi.agp.dao.tables.anexo.AnexoModSWComparativas" />
        </set>
    </class>
</hibernate-mapping>
