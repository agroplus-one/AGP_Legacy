<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- Generated by T-Systems -->
<hibernate-mapping>
    <class name="com.rsi.agp.dao.tables.sbp.PolizaSbp" table="TB_SBP_POLIZAS">
        <comment>Tabla de p&#243;lizas de sobreprecio</comment>
        <id name="id" type="long">
            <column name="ID" precision="15" scale="0" />
            <generator class="sequence">
            	<param name="sequence">SQ_SBP_POLIZAS</param>
            </generator>
        </id>
        <many-to-one name="estadoPlzSbp" class="com.rsi.agp.dao.tables.sbp.EstadoPlzSbp" fetch="select">
            <column name="IDESTADO" precision="15" scale="0" not-null="true">
                <comment>Identificador del estado del sobreprecio</comment>
            </column>
        </many-to-one>
		<many-to-one name="polizaCplCopy" class="com.rsi.agp.dao.tables.copy.Poliza" fetch="select">
            <column name="IDCOPYCOM" precision="15" scale="0">
                <comment>Id de la copy de la p&#243;liza complementaria</comment>
            </column>
        </many-to-one>
        <many-to-one name="polizaPpal" class="com.rsi.agp.dao.tables.poliza.Poliza" fetch="select">
            <column name="IDPOLIZA" precision="15" scale="0" not-null="true">
                <comment>ID de la p&#243;liza principal</comment>
            </column>
        </many-to-one>
        <many-to-one name="tipoEnvio" class="com.rsi.agp.dao.tables.sbp.TipoEnvio" fetch="select">
            <column name="TIPOENVIO" precision="1" scale="0">
                <comment>Tipo de envio</comment>
            </column>
        </many-to-one>
		<many-to-one name="polizaPpalCopy" class="com.rsi.agp.dao.tables.copy.Poliza" fetch="select">
            <column name="IDCOPY" precision="15" scale="0">
                <comment>Id de la copy de la p&#243;liza principal</comment>
            </column>
        </many-to-one>
        <many-to-one name="polizaCpl" class="com.rsi.agp.dao.tables.poliza.Poliza" fetch="select">
            <column name="IDPOLIZACOM" precision="15" scale="0">
                <comment>ID de la p&#243;liza complementaria</comment>
            </column>
        </many-to-one>
        <property name="incSbpComp" type="java.lang.Character">
            <column name="INC_SBP_COMP" length="1" not-null="true">
                <comment>Si est&#225; incluido el sobreprecio en los datos de la complementaria (S/N)</comment>
            </column>
        </property>
        
            
     
        <property name="referencia" type="string">
            <column name="REFERENCIA" length="7">
                <comment>Referencia de la p&#243;liza</comment>
            </column>
        </property>
        <property name="importe" type="java.math.BigDecimal">
            <column name="IMPORTE" precision="11" scale="2">
                <comment>Importe de la p√≥liza</comment>
            </column>
        </property>
        
        <property name="prodTecnico" type="java.math.BigDecimal">
            <column name="PROD_TECNICO" precision="4" scale="0">
                <comment>Producto t&#233;cnico</comment>
            </column>
        </property>
        <property name="refPlzOmega" type="java.math.BigDecimal">
            <column name="REF_PLZ_OMEGA" precision="9" scale="0">
                <comment>Referencia de la p&#243;liza en OMEGA</comment>
            </column>
        </property>
        <property name="genSplCpl" type="java.lang.Character">
            <column name="GEN_SPL_CPL" length="1">
                <comment>Indica si hay que comprobar la generaci&#243;n de un suplemento para este sobreprecio</comment>
            </column>
        </property>
        
        <property name="usuarioProvisional" type="string"   	lazy="true"  formula="(select bh.CODUSUARIO from o02agpe0.VW_SBP_HISTORICO_ESTADOS_ASC bh where bh.IDPOLIZA_SBP = ID and rownum=1)"/>
       
        <property name="fechaProvisional" type="java.util.Date" lazy="true"  formula="(select bh.FECHA from o02agpe0.VW_SBP_HISTORICO_ESTADOS_DESC bh where bh.IDPOLIZA_SBP = ID and bh.ESTADO=1 and rownum=1)"/>
           
      	<property name="usuarioDefinitiva" type="string"        lazy="true"  formula="(select bh.CODUSUARIO from o02agpe0.VW_SBP_HISTORICO_ESTADOS_DESC bh where bh.IDPOLIZA_SBP = ID  and bh.ESTADO=2 and rownum=1)"/>
        
        <property name="fechaDefinitiva" type="java.util.Date"  lazy="true"  formula="(select bh.FECHA from o02agpe0.VW_SBP_HISTORICO_ESTADOS_DESC bh where bh.IDPOLIZA_SBP = ID  and bh.ESTADO=2 and rownum=1)"/>
        
        <property name="fechaEnvioSbp" type="java.util.Date"    lazy="true"  formula="(select bh.FECHA from o02agpe0.VW_SBP_HISTORICO_ESTADOS_DESC bh where bh.IDPOLIZA_SBP = ID  and bh.ESTADO=3 and rownum=1)"/>
        
        <one-to-one name="errorPlzSbp" class="com.rsi.agp.dao.tables.sbp.ErrorPlzSbp" cascade="delete"></one-to-one>
        
        <!-- P0073325 - RQ.10, RQ.11 y RQ.12 -->
        <one-to-one name="gedDocPolizaSbp" class="com.rsi.agp.dao.tables.ged.GedDocPolizaSbp" cascade="delete" />
        
        <set name="parcelaSbps" table="TB_SBP_PARCELAS" inverse="true" lazy="true" fetch="select">
            <key>
                <column name="IDPOLIZA_SBP" precision="15" scale="0" not-null="true">
                    <comment>Identificador de la p&#243;liza de sobreprecio a la que est&#225; asociada la parcela</comment>
                </column>
            </key>
            <one-to-many class="com.rsi.agp.dao.tables.sbp.ParcelaSbp" />
        </set>
    </class>
</hibernate-mapping>
