<?xml version="1.0" encoding="UTF-8"?>
<x:schema 
	targetNamespace="http://www.agroseguro.es/SeguroAgrario/RendimientosCalculo"
	xmlns="http://www.agroseguro.es/SeguroAgrario/RendimientosCalculo"
	xmlns:pks="http://www.agroseguro.es/SeguroAgrario/RendimientosCalculo"
	xmlns:x="http://www.w3.org/2001/XMLSchema"
	xmlns:ti="http://www.agroseguro.es/Tipos"> 

	<!-- Importacion de la definicion de tipos genericos -->
	<x:import
		namespace="http://www.agroseguro.es/Tipos"
		schemaLocation="Tipos.xsd" />
	
	<x:element name="Poliza" type="Poliza" >
		<x:key name="Cosecha_PK">
			<x:selector xpath="Cosecha" />
			<x:field xpath="@codigoCosecha" />
		</x:key>
	</x:element>	
	
	<x:complexType name="Poliza">
		<x:sequence>
			<x:element name="Cosecha" type="Cosecha" minOccurs="1" maxOccurs="unbounded" >
				<x:key name="Parcela_PK">
					<x:selector xpath="Parcela" />
					<x:field xpath="@hoja" />
					<x:field xpath="@numero" />			
				</x:key>
			</x:element>	
		</x:sequence>
		<x:attributeGroup ref="ti:PlanLinea" />
		<x:attributeGroup ref="ti:PeticionSW" />
	</x:complexType>

	<x:complexType name="Club">
		<x:attribute name="coeficienteRendimiento" type="ti:Coeficiente_Rendimiento" />
		<x:attribute name="tablaRendimientos"  type="ti:Rendimientos_Tabla" />
		<x:attribute name="observaciones" type="x:string" use="optional"/>
		<x:attribute name="codigo" type="x:int" use="optional"/>
	</x:complexType>
	
	<x:complexType name="Individualizado">
		<x:choice>
			<x:element name="Directo" type="LimitacionRendimiento" minOccurs="0" maxOccurs="1" />
			<x:element name="SobreZonal" type="SobreZonal" minOccurs="0" maxOccurs="1" />
		</x:choice>
		<x:attribute name="observaciones" type="x:string" use="optional"/>
		<x:attribute name="codigo" type="x:int" use="optional"/>
	</x:complexType>

	<x:complexType name="SobreZonal">
		<x:attribute name="coeficienteAplicarRendimientos" type="Coeficiente" use="required" />
	</x:complexType>

	<x:complexType name	="Cosecha" >
		<x:sequence>
			<x:element name="CriteriosUtilizados" minOccurs="0" maxOccurs="1" type="CriteriosUtilizadosCosecha" />
			<x:element name="ControlCosechaAplicar" type="ControlAplicar" minOccurs="0" maxOccurs="1"  />
			<x:element name="Parcela" type="Parcela" minOccurs="1" maxOccurs="unbounded" />
		</x:sequence>
		<x:attribute name="codigoCosecha" type="CodigoCosecha" use="required" />
	</x:complexType>
	
	<x:complexType name="CriteriosUtilizadosCosecha">
		<x:sequence>
			<x:element name="Individualizado" type="Individualizado" minOccurs="0" maxOccurs="1" />			
			<x:element name="Zonal" type="Zonal" minOccurs="0" maxOccurs="1" />
			<x:element name="Club" type="Club" minOccurs="0" maxOccurs="1" />
		</x:sequence>
	</x:complexType> 
	
	<x:complexType name="Zonal">
		<x:choice>
			<x:element name="Directo" type="LimitacionRendimiento" minOccurs="0" maxOccurs="1" />
			<x:element name="SobreIndividualizado" type="SobreIndividualizado" minOccurs="0" maxOccurs="1" />
		</x:choice>
		<x:attribute name="observaciones" type="x:string" use="optional"/>
		<x:attribute name="codigo" type="x:int" use="optional"/>
	</x:complexType>
	
	<x:complexType name="SobreIndividualizado">
		<x:attribute name="coeficienteAplicarRendimientos" type="Coeficiente" use="required" />
	</x:complexType>
	

	<x:complexType name="ControlAplicar">
		<x:attribute name="limInfRendimientos" type="LimiteRendimiento" use="optional" />
		<x:attribute name="limSupRendimientos" type="LimiteRendimiento" use="optional" />
		<x:attribute name="ConceptoConsiderado" type="ConceptoConsiderado" use="optional" />
		<x:attribute name="produccionMinima" type="Produccion" use="optional" />
		<x:attribute name="produccionMaxima" type="Produccion" use="optional" />
		<x:attribute name="observaciones" type="x:string" use="optional"/>
		<x:attribute name="codigo" type="x:int" use="optional"/>
	</x:complexType>
	
	<x:complexType name="Parcela">
		<x:sequence>
			<x:element name="CriteriosUtilizados"  minOccurs="0" maxOccurs="1"  type="CriteriosUtilizadosParcela" />
			<x:element name="ControlParcelaAplicar" minOccurs="0" maxOccurs="1" type="ControlAplicar" />
			<x:element name="ControlParcelaAjustado" minOccurs="0" maxOccurs="1" type="ControlParcelaAjustado" />
			<x:element name="HistoricoNoAplicado" minOccurs="0" maxOccurs="1" type="HistoricoNoAplicado" />			
		</x:sequence>
		<x:attribute name="hoja" use="required" type="ti:Parcela_Hoja" />
		<x:attribute name="numero" use="required" type="ti:Parcela_Numero" />
		<x:attribute name="tipo" type="ti:TipoCapital" use="optional" default="0" />
		<x:attribute name="superficie" type="ti:Parcela_Superficie" use="required" />
		<x:attribute name="produccion" use="required" type="ti:ProduccionKG" />
		<x:attribute name="unidades" use="required" type="ti:NumeroUnidadesCapital" />
	</x:complexType>
	
	<x:complexType name="CriteriosUtilizadosParcela">
		<x:sequence>
			<x:element name="Individualizado" type="Individualizado" minOccurs="0" maxOccurs="1" />			
			<x:element name="Zonal" type="Zonal" minOccurs="0" maxOccurs="1" />
			<x:element name="Especifico" type="LimitacionRendimiento" minOccurs="0" maxOccurs="1" />
			<x:element name="Club" type="Club" minOccurs="0" maxOccurs="1" />
			<x:element name="ReduccionEnParcela" type="ReduccionEnParcela" minOccurs="0" maxOccurs="1" />
		</x:sequence>
	</x:complexType> 
	
	<x:complexType name="LimitacionRendimiento"  >
		<x:attribute name="limInfRendimientos" type="LimiteRendimiento" use="optional" />
		<x:attribute name="limSupRendimientos" type="LimiteRendimiento" use="optional" />
		<x:attribute name="conceptoConsiderado" type="ConceptoConsiderado" use="optional" />
		<x:attribute name="observaciones" type="x:string" use="optional"/>
		<x:attribute name="codigo" type="x:int" use="optional"/>
	</x:complexType>
	
	<x:complexType name="ReduccionEnParcela">
		<x:attribute name="porcentajeReduccion" type="Porcentaje" use="required" />
	</x:complexType>
	
	<x:complexType name="ControlParcelaAjustado">
		<x:attribute name="produccionMinima" type="Produccion" use="optional" />
		<x:attribute name="produccionMaxima" type="Produccion" use="optional" />
		<x:attribute name="produccion" type="Produccion" use="optional" />
		<x:attribute name="observaciones" type="x:string" use="optional"/>
		<x:attribute name="codigo" type="x:int" use="optional"/>
	</x:complexType>
	
	<x:complexType name="HistoricoNoAplicado">
		<x:attribute name="limRendimientos" type="LimiteRendimiento" use="optional"/>
		<x:attribute name="produccion" type="Produccion" use="optional"/>
		<x:attribute name="observaciones" type="x:string" use="optional"/>
		<x:attribute name="codigo" type="x:int" use="optional"/>
	</x:complexType>

	
	<x:simpleType name="ConceptoConsiderado">
		<x:restriction base="x:token">
			<x:enumeration value="S" />
			<x:enumeration value="U" />
		</x:restriction>
	</x:simpleType>
	
	<x:simpleType name="Porcentaje">
		<x:restriction base="x:int">
			<x:totalDigits value="3" />
			<x:minInclusive value="1" />			
		</x:restriction>
	</x:simpleType>
	
	
	<x:simpleType name="LimiteRendimiento" >
		<x:restriction base="x:decimal" >
			<x:totalDigits value="11" />
			<x:fractionDigits value="4" />
		</x:restriction>
	</x:simpleType>
	
	<x:simpleType name="Produccion" >
		<x:restriction base="x:int" >
			<x:totalDigits value="13" />
		</x:restriction>
	</x:simpleType>
	
	
	<x:simpleType name="CodigoCosecha">
		<x:restriction base="x:int" >
			<x:totalDigits value="5" />
		</x:restriction>
    </x:simpleType>
	
	<x:simpleType name="Coeficiente">
		<x:restriction base="x:decimal">
			<x:totalDigits value="3" />
			<x:fractionDigits value="2" />
		</x:restriction>
	</x:simpleType>
</x:schema>